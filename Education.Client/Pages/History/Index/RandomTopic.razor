@using Education.Client.Gateways.History

<div class="grid @Class">
    <div class="image">
        <img src="/images/history/history.jpg" alt="history"/>
    </div>
    <article class="text">
        <MudText Typo="Typo.subtitle1" Color="Color.Default" Class="mb-10">
            <em>
                From today's random topic
            </em>
        </MudText>

        <MudText Typo="Typo.h2" Color="Color.Inherit" Class="mb-3">
            @L["Topic:Random"]
        </MudText>
        @* <MudText Typo="Typo.subtitle1" Class="mb-6"> *@
        @* Overview *@
        @* </MudText> *@

        <LoadingButton OnClick="@OnClick" IsLoading="@_isLoading" Text="@L["Search"]"/>
    </article>
</div>

@code {

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Inject]
    private IHistoryClient Client { get; set; } = default!;

    [Inject]
    private NavigationManager Navigation { get; set; } = default!;

    [Parameter]
    public string? Class { get; set; }

    private bool _isLoading;

    private async Task OnClick()
    {
        if (_isLoading)
            return;

        _isLoading = true;
        var result = await Client.Topic.GetRandomAsync();
        if (result.Status == ResponseStatus.Success)
            Navigation.NavigateTo(Links.History.TopicById(result.Data.Id));

        _isLoading = false;
    }

}
