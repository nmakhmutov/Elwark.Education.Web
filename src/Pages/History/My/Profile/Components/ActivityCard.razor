@using Education.Web.Gateways.History.Users.Model
@using ApexCharts
@using Color = MudBlazor.Color

<MudPaper Class="@($"d-flex flex-column justify-space-between {Class}")" Elevation="0">
    <MudStack Row AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Class="pa-3">
        <MudText Typo="Typo.h5">
            @L["Test:MyActivity"]
        </MudText>
        <MudButton 
            DisableElevation 
            Variant="Variant.Filled"
            Color="Color.Primary"
            Href="@HistoryLinks.User.MyActivities">
            @L["Button:Details"]
        </MudButton>
    </MudStack>
    <ApexChart @ref="@_chart" TItem="HistoryUserProfileModel.DailyItem" Options="_options" Height="@("240px")">
        <ApexPointSeries
            TItem="HistoryUserProfileModel.DailyItem"
            Items="Activities"
            Name="@L["NumberOfTests:Total"]"
            Stroke="@(new SeriesStroke { Width = 5, Color = "#5569FF" })"
            SeriesType="SeriesType.Area"
            XValue="@(e => e.Day)"
            YValue="@(x => x.Total)"/>
    </ApexChart>
</MudPaper>

@code {
    private ApexChart<HistoryUserProfileModel.DailyItem> _chart = default!;

    private ApexChartOptions<HistoryUserProfileModel.DailyItem> _options = new()
    {
        Tooltip = new Tooltip
        {
            Enabled = false
        },
        Chart = new Chart
        {
            Toolbar = new Toolbar
            {
                Show = false
            },
            Selection = new Selection
            {
                Enabled = false
            },
            Zoom = new Zoom
            {
                Enabled = false
            },
            Sparkline = new ChartSparkline
            {
                Enabled = true
            },
            Background = "transparent",
            ForeColor = "var(--mud-palette-text-primary)",
        },
        Grid = new Grid
        {
            BorderColor = "var(--mud-palette-divider)",
        }
    };

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Parameter]
    public string? Class { get; set; }

    [Parameter, EditorRequired]
    public HistoryUserProfileModel.DailyItem[] Activities { get; set; } = Array.Empty<HistoryUserProfileModel.DailyItem>();

}
