@using Education.Web.Gateways.History.Users.Model
@using ApexCharts
@using Color = MudBlazor.Color

<MudCard Class="@($"d-flex flex-column {Class}")" Elevation="0">
    <MudCardHeader Class="pa-3">
        <CardHeaderContent>
            <div class="d-flex align-center justify-space-between">
                <MudText Typo="Typo.h5">
                    @L["Test:MyActivity"]
                </MudText>
                <MudButton DisableElevation Variant="Variant.Filled" Color="Color.Primary" Href="@HistoryLinks.User.MyActivities">
                    @L["Button:Details"]
                </MudButton>
            </div>
        </CardHeaderContent>
    </MudCardHeader>
    <MudCardContent Class="pa-0 h-100">
        <ApexChart @ref="@_chart" TItem="HistoryUserProfileModel.DailyItem" Options="_options" Height="@("100%")">
            <ApexPointSeries
                TItem="HistoryUserProfileModel.DailyItem"
                Items="Activities"
                Name="@L["NumberOfTests:Total"]"
                Stroke="@(new SeriesStroke { Width = 3, Color = "#5569FF" })"
                SeriesType="SeriesType.Area"
                XValue="@(e => e.Day)"
                YValue="@(x => x.Total)"/>
        </ApexChart>
    </MudCardContent>
</MudCard>

@code {
    private ApexChart<HistoryUserProfileModel.DailyItem> _chart = default!;

    private ApexChartOptions<HistoryUserProfileModel.DailyItem> _options = new()
    {
        Tooltip = new Tooltip
        {
            Enabled = false
        },
        Chart = new Chart
        {
            Toolbar = new Toolbar
            {
                Show = false
            },
            Selection = new Selection
            {
                Enabled = false
            },
            Zoom = new Zoom
            {
                Enabled = false
            },
            Sparkline = new ChartSparkline
            {
                Enabled = true
            },
            Background = "transparent",
            ForeColor = "var(--mud-palette-text-primary)",
        },
        Grid = new Grid
        {
            BorderColor = "var(--mud-palette-divider)",
        }
    };

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Parameter]
    public string? Class { get; set; }

    [Parameter, EditorRequired]
    public HistoryUserProfileModel.DailyItem[] Activities { get; set; } = Array.Empty<HistoryUserProfileModel.DailyItem>();

}
