@using Education.Web.Client.Features.History.Clients
@using Education.Web.Client.Features.History.Clients.Article
@using Education.Web.Client.Features.History.Clients.Article.Request
@using Education.Web.Client.Features.History.Clients.Learner
@using Education.Web.Client.Clients
<EduFillGrid>
    <ApiViewer Result="@_result" OnReloadClick="@OnInitializedAsync">
        <Loading>
            @for (var i = 0; i < 12; i++)
            {
                <SkeletonCard/>
            }
        </Loading>
        <ChildContent Context="articles">
            @foreach (var item in articles.Items)
            {
                <ArticleCard
                    Article="@item.Article"
                    HasQuiz="@item.HasQuiz"
                    Activity="@item.Activity"
                    OnBookmarkClick="@LearnerClient.ToggleArticleBookmarkAsync"
                    OneLineTitle/>
            }
        </ChildContent>
    </ApiViewer>
</EduFillGrid>

@code {

    private ApiResult<PagingOffsetModel<UserArticleOverviewModel>> _result =
        ApiResult<PagingOffsetModel<UserArticleOverviewModel>>.Loading();

    [Inject]
    private IHistoryArticleClient ArticleClient { get; set; } = default!;

    [Inject]
    private IHistoryLearnerClient LearnerClient { get; set; } = default!;

    protected override async Task OnInitializedAsync() =>
        _result = await ArticleClient
            .GetAsync(new GetArticlesRequest(EpochType.None, GetArticlesRequest.SortType.Newest, 0, 12));

}