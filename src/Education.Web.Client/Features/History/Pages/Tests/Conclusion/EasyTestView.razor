@using Education.Web.Client.Features.History.Services.Test.Model
<EduContainer Class="pa-3 pa-sm-6" MaxWidth="EduWidth.W1280">
    <div class="mb-3">
        <MudLink Href="@HistoryUrl.User.MyArticle(Conclusion.Article.Id)" Typo="Typo.h5">
            @L["Statistics"]
        </MudLink>
    </div>
    <ConclusionCharts Conclusion="@Conclusion"/>
</EduContainer>

<EduContainer Class="pa-3 pa-sm-6" MaxWidth="EduWidth.W1280">
    <div class="mb-3">
        <MudLink Href="@HistoryUrl.Content.Article(Conclusion.Article.Id)" Typo="Typo.h5">
            @Conclusion.Article.Title
        </MudLink>
    </div>
    <MudTable Class="mb-3 mb-sm-6" Items="@Conclusion.Questions" Breakpoint="Breakpoint.Xs" Elevation="0" Hover>
        <HeaderContent>
            <MudTh>@L["Question"]</MudTh>
            <MudTh>@L["Question:IsAnswered"]</MudTh>
            <MudTh>@L["Question:Correct"]</MudTh>
            <MudTh>@L["Question:Incorrect"]</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="@L["Question"]">
                @context.Title
            </MudTd>
            <MudTd DataLabel="@L["Question:IsAnswered"]">
                <MudIcon
                    Size="Size.Small"
                    Icon="@(context.IsAnswered ? Icons.Material.Outlined.Check : Icons.Material.Outlined.Close)"/>
            </MudTd>
            <MudTd DataLabel="@L["Question:Correct"]">
                @context.Correct
            </MudTd>
            <MudTd DataLabel="@L["Question:Incorrect"]">
                @context.Incorrect
            </MudTd>
        </RowTemplate>
        <FooterContent>
            <MudTh/>
            <MudTh>
                @Conclusion.Questions.Count(x => x.IsAnswered) / @Conclusion.Questions.Length
            </MudTh>
            <MudTh>
                @Conclusion.Questions.Sum(x => x.Correct) / @Conclusion.Questions.Length
            </MudTh>
            <MudTh>
                @Conclusion.Questions.Sum(x => x.Incorrect) / @Conclusion.Questions.Length
            </MudTh>
        </FooterContent>
    </MudTable>

    <div class="d-flex justify-center">
        <MudButton
            Href="@HistoryUrl.ArticleTest.Index(Conclusion.Article.Id)"
            Color="Color.Primary"
            Variant="Variant.Filled"
            DisableElevation>
            @L["Shared_TakeTheTestAgain"]
        </MudButton>
    </div>
</EduContainer>

@code {

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Parameter]
    public TestConclusion.EasyTestModel Conclusion { get; set; } = default!;

}