@using Microsoft.AspNetCore.Components.Rendering
@inherits MudButton

@{ base.BuildRenderTree(__builder); }

@code {

    [Parameter, EditorRequired]
    public bool IsLoading { get; set; }

    [Parameter, EditorRequired]
    public string Text { get; set; } = string.Empty;

    [Parameter]
    public string? LoadingText { get; set; }

    protected override void OnParametersSet()
    {
        Disabled = Disabled || IsLoading;
        ChildContent = RenderFragment;
    }

    private void RenderFragment(RenderTreeBuilder builder)
    {
        if (IsLoading)
        {
            builder.AddContent(1, @<MudProgressCircular Size="Size.Small" Indeterminate/>);
            if (!string.IsNullOrEmpty(LoadingText))
                builder.AddContent(2, @<MudText Typo="Typo.button" Class="ms-2">@LoadingText</MudText>);
        }
        else
        {
            builder.AddContent(1, @<MudText Typo="Typo.button">@Text</MudText>);
        }
    }

}