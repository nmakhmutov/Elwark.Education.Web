@using Education.Web.Client.Services.History.Store
@using Education.Web.Client.Services.History.Store.Model

@page "/history/store"
@layout HistoryLayout
@attribute [Authorize]

<EduPage Title="@L["Inventory:Store"]">
    <EduContainer Class="py-3 py-sm-6" MaxWidth="EduWidth.W1920">
        <EduPageHeader Title="@L["Inventory:Store"]" Breadcrumbs="@Breadcrumbs"/>
    </EduContainer>
    <ApiViewer Result="@_response" Context="products">
        <EduContainer Class="pb-3 pb-sm-6" MaxWidth="EduWidth.W1920">
            <EduFillGrid>
                @foreach (var item in products)
                {
                    <MudCard Elevation="0">
                        <MudCardContent>
                            <MudText>@item.Title</MudText>
                            <MudText>Weight @item.InventoryWeight</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Class="mr-3" Variant="Variant.Filled" Color="Color.Primary" DisableElevation FullWidth>
                                <InternalMoney Money="@item.Selling.Total" IconSize="Size.Small" Horizontal/>
                            </MudButton>
                            <MudIconButton Icon="@Icons.Outlined.Info" Variant="Variant.Filled" DisableElevation/>
                        </MudCardActions>
                    </MudCard>
                }
            </EduFillGrid>
        </EduContainer>
    </ApiViewer>
</EduPage>

@code {
    private ApiResult<ProductModel[]> _response = ApiResult<ProductModel[]>.Loading();

    private List<BreadcrumbItem> Breadcrumbs => new()
    {
        new BreadcrumbItem(L["Subject:History"].Value, HistoryUrl.Root)
    };

    [Inject]
    private IHistoryStoreService Store { get; set; } = default!;

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    protected override async Task OnInitializedAsync() =>
        _response = await Store.GetAsync();

}