@using System.Diagnostics
@typeparam T

@switch (Result.Status)
{
    case Status.Loading when Loading is null:
        <Spinner/>
        break;

    case Status.Loading when Loading is not null:
        @Loading
        break;

    case Status.Error when Error is null && Result.UnwrapError() is { } error:
        <PageTitle>
            @error.Title
        </PageTitle>
        <EduErrorContainer
            Class="align-center justify-center flex-grow-1"
            Error="@error"
            OnReloadClick="@OnReloadClick"/>
        break;

    case Status.Error when Error is not null:
        @Error(Result.UnwrapError())
        break;

    case Status.Success:
        @ChildContent(Result.Unwrap())
        break;

    default:
        throw new UnreachableException($"Unknown loading status {Result.Status}");
}


@code {

    [Parameter, EditorRequired]
    public ApiResult<T> Result { get; set; } = ApiResult<T>.Loading();

    [Parameter]
    public RenderFragment<T> ChildContent { get; init; } = default!;

    [Parameter]
    public RenderFragment? Loading { get; set; }

    [Parameter]
    public RenderFragment<Error>? Error { get; set; }

    [Parameter]
    public EventCallback OnReloadClick { get; set; }

}