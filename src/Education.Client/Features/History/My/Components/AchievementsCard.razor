@using System.ComponentModel
@using Education.Client.Gateways.History.Me

<MudCard Class="@Class">
    <MudCardHeader Class="pa-3 pa-sm-6">
        <CardHeaderAvatar>
            <MudAvatar Color="Color.Primary" Size="Size.Medium">
                <MudIcon Icon="@EducationIcons.Achievement" Size="Size.Medium"/>
            </MudAvatar>
        </CardHeaderAvatar>
        <CardHeaderContent>
            <MudText Typo="Typo.h6">
                @L["Achievements"]
            </MudText>
        </CardHeaderContent>
        <CardHeaderActions>
            @* <HumanReadableText Value="@Value" Typo="Typo.h5" Class="mt-2 mr-2"/> *@
        </CardHeaderActions>
    </MudCardHeader>
    <MudCardContent Class="pa-3 pa-sm-6">
        @foreach (var achievement in Achievements)
        {
            switch (achievement)
            {
                case CumulativeAchievement (var name, var level, var earned, var goal, var progress, var reward):
                    <div class="mb-3">
                        <div class="d-flex flex-row justify-space-between align-end">
                            <div>
                                <MudText Typo="Typo.subtitle1">
                                    @L[$"Achievement:{name}"]
                                </MudText>
                                <MudText Typo="Typo.body2">
                                    @L["Achievement:Level"]: @level
                                </MudText>
                                <MudText Typo="Typo.caption">
                                    @reward
                                </MudText>
                            </div>
                            <MudText Typo="Typo.subtitle1">
                                @earned / @goal
                            </MudText>
                        </div>

                        <MudProgressLinear Min="0" Max="100" Value="@progress" Color="Color.Primary"/>
                    </div>
                    break;

                case var (name, progress, reward):
                    <div class="mb-3">
                        <div class="d-flex flex-row justify-space-between align-end">
                            <div>
                                <MudText Typo="Typo.subtitle1">
                                    @L[$"Achievement:{name}"]
                                </MudText>
                                <MudText Typo="Typo.caption">
                                    Reward: @reward
                                </MudText>
                            </div>
                        </div>

                        <MudProgressLinear Min="0" Max="100" Value="@progress" Color="Color.Primary"/>
                    </div>
                    break;
            }
        }
    </MudCardContent>
</MudCard>

@code {

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Parameter]
    public string? Class { get; set; }

    [Parameter, EditorRequired]
    public Achievement[] Achievements { get; set; } = Array.Empty<Achievement>();

}
