@using Education.Client.Gateways.History
@inherits LayoutComponentBase

<MudThemeProvider Theme="@ThemeProvider.Theme"/>
<MudDialogProvider/>
<MudSnackbarProvider/>

<MudLayout>
    <MudAppBar Elevation="25">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@SidebarService.ToggleAsync"/>
        <MudLink Href="@Links.History.Index" Typo="Typo.h5" Color="Color.Default" Underline="Underline.None">
            @L["Subject:History"] <sup class="mud-typography mud-typography-caption mud-primary-text">beta</sup>
        </MudLink>
        <MudSpacer/>
        <MudIconButton Icon="@ThemeProvider.Icon" Color="Color.Inherit" OnClick="@ThemeProvider.ToggleAsync"/>
    </MudAppBar>
    <MudDrawer Open="@SidebarService.IsOpen" OpenChanged="@SidebarService.SetAsync" Breakpoint="Breakpoint.Lg" ClipMode="DrawerClipMode.Docked" Elevation="25">
        <UserDrawerHeader/>
        <MudNavMenu>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.Index" Icon="@EducationIcons.History">
                @L["Page:Home"]
            </MudNavLink>
            <MudNavGroup Title="@L["History:Epochs"]" Icon="@EducationIcons.Epochs">
                @foreach (var epoch in Enum.GetValues<EpochType>().Where(x => x != EpochType.None))
                {
                    <MudNavLink Href="@Links.History.TopicByEpoch(epoch)">
                        @L[$"History:{epoch}"]
                    </MudNavLink>
                }
            </MudNavGroup>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.Empires" Icon="@EducationIcons.Empires">
                @L["History:Empires"]
            </MudNavLink>
            <MudDivider Class="my-2"/>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.TestBuilder" Icon="@EducationIcons.Tests">
                @L["Tests"]
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.EventGuesserBuilder" Icon="@EducationIcons.EventGuesser">
                @L["EventGuesser"]
            </MudNavLink>
            <MudDivider Class="my-2"/>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.MyProfile" Icon="@EducationIcons.MyProfile">
                @L["Profile"]
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Href="@Links.History.MyTopics" Icon="@EducationIcons.MyTopics">
                @L["Test:MyProgress"]
            </MudNavLink>
        </MudNavMenu>
    </MudDrawer>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>

@code {

    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Inject]
    private ThemeProvider ThemeProvider { get; set; } = default!;

    [Inject]
    private SidebarService SidebarService { get; set; } = default!;

}
