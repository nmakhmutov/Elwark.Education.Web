@page "/history/my/inventories"

@layout HistoryLayout
@attribute [Authorize]

@using Education.Client.Gateways.History.User
@using Education.Client.Gateways.History

<PageTitle>@L["Inventories"]</PageTitle>

<EduPage Subject="@L["Subject:History"]" ShowFooter="true">
    <ApiViewer Response="@_response">
        <Success Context="inventory">
            <EduContainer>
                <PageHeader Title="@L["Inventory"]" Class="mb-3 mb-sm-6" Breadcrumbs="@Breadcrumbs">
                    <MudText Typo="Typo.h5">
                        @inventory.Fullness / @inventory.Capacity
                    </MudText>
                </PageHeader>
            </EduContainer>
        </Success>
    </ApiViewer>
</EduPage>

@code {
    private List<BreadcrumbItem> Breadcrumbs => new()
    {
        new BreadcrumbItem(L["Account"].Value, Links.Account.Index),
        new BreadcrumbItem(L["Profile"].Value, Links.History.User.MyProfile)
    };
    
    private ApiResponse<Inventory> _response = ApiResponse<Inventory>.Loading();
    
    [Inject]
    private IStringLocalizer<App> L { get; set; } = default!;

    [Inject]
    private IHistoryClient Client { get; set; } = default!;

    protected override async Task OnInitializedAsync() =>
        _response = await Client.User.GetInventoryAsync();

}
